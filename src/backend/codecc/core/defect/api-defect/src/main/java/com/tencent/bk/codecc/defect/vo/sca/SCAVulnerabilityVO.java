package com.tencent.bk.codecc.defect.vo.sca;

import io.swagger.v3.oas.annotations.media.Schema;
import lombok.Data;

import java.util.List;

@Data
@Schema(description = "SCA漏洞类视图")
public class SCAVulnerabilityVO {
    @Schema(description = "任务Id")
    private long taskId;

    @Schema(description = "工具名")
    private String toolName;

    @Schema(description = "漏洞数据库Id")
    private String entityId;

    // todo：以下数据待补全
    @Schema(description = "风险等级")
    private int severity;

    /**
     * 告警状态：NEW(1), FIXED(2), IGNORE(4), PATH_MASK(8), CHECKER_MASK(16);
     */
    @Schema(description = "告警状态")
    private int status;

    @Schema(description = "处理人")
    private List<String> author;

    @Schema(description = "组件名称")
    private String packageName;

    @Schema(description = "组件版本")
    private String packageVersion;

    @Schema(description = "组件ID")
    private String packageId;

    @Schema(description = "漏洞名称")
    private String name;

    /**
     * 后台漏洞数据的唯一标识使用CommonEntity数据库的entityId作为唯一标识
     * 该字段包含荷鲁斯对该漏洞的的编号、漏洞其它编号，比如 CWE、CVE、CNVD 等其他 ID
     */
    @Schema(description = "漏洞Id")
    private List<String> vulnerabilityIds;

    @Schema(description = "漏洞类型")
    private String vulType;

    @Schema(description = "攻击类型")
    private String attackType;

    @Schema(description = "是否可被利用")
    private Boolean exploitable;

    @Schema(description = "漏洞数据发布时间")
    private Long publishedDate;

    @Schema(description = "漏洞数据更新时间")
    private Long modifiedDate;

    @Schema(description = "告警忽略时间")
    private Long ignoreTime;

    @Schema(description = "告警忽略原因类型")
    private Integer ignoreReasonType;

    @Schema(description = "告警忽略原因")
    private String ignoreReason;

    @Schema(description = "告警忽略操作人")
    private String ignoreAuthor;

    /**
     * 告警是否被标记为已修改的标志，checkbox for developer, 0 is normal, 1 is tag, 2 is prompt
     */
    @Schema(description = "告警是否被标记为已修改的标志")
    private Integer mark;

    @Schema(description = "告警被标记为已修改的时间")
    private Long markTime;

    @Schema(description = "标记了，但是再次扫描没有修复")
    private Boolean markButNoFixed;

    /**
     * 预留，当前工具暂未上报cvss评分
     */
    @Schema(description = "cvssV3评分")
    private SCAVulnerabilityRatingVO cvssV3;

    @Schema(description = "cvssV2评分")
    private SCAVulnerabilityRatingVO cvssV2;

}
